FROM jolielang/jolie:edge-alpine

WORKDIR /app
RUN apk add --no-cache openjdk11

COPY *.ol /app
COPY docker/function_catalog_params.json params.json
COPY Checksum.java /app/jfn/Checksum.java

RUN javac -cp /usr/lib/jolie/jolie.jar jfn/Checksum.java
RUN jar cvf checksum.jar jfn/Checksum.class
RUN mkdir lib && mv checksum.jar lib/checksum.jar

RUN apk del openjdk11

EXPOSE 6000
VOLUME /data

CMD jolie --params params.json function_catalog.ol
